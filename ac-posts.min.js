(function(){var a=document.getElementsByTagName("script");var e=a[a.length-1].src;if(e.length==0){e=window.installPath+"/ac-angular-posts/includes/ac-posts.php"}angular.module("acPosts",[]).factory("PostService",b).service("PostVars",c).factory("CommentService",d).service("CommentVars",f);b.$inject=["$http","PostVars","$cacheFactory","AcUtils"];function b(r,h,s,l){var q={};var i=e.replace("ac-posts.js","/includes/ac-posts.php");q.get=j;q.getByParams=t;q.create=p;q.update=m;q.remove=n;q.goToPagina=g;q.next=o;q.prev=k;return q;function j(x){var u=i+"?function=getPosts";var w=s.get("$http");var v=[];if(w.get(u)!=undefined){if(h.clearCache){w.remove(u)}else{v=w.get(u);x(v);return}}return r.get(u,{cache:true}).success(function(y){w.put(u,y);h.clearCache=false;h.paginas=(y.length%h.paginacion==0)?parseInt(y.length/h.paginacion):parseInt(y.length/h.paginacion)+1;x(y)}).error(function(y){x(y);h.clearCache=false})}function t(w,u,v,x){j(function(y){l.getByParams(w,u,v,y,x)})}function n(u,v){return r.post(i,{"function":"removePost",post_id:u}).success(function(w){if(w!=="false"){h.clearCache=true;v(w)}}).error(function(w){v(w)})}function p(u,v){return r.post(i,{"function":"createPost",post:JSON.stringify(u)}).success(function(w){h.clearCache=true;v(w)}).error(function(w){h.clearCache=true;v(w)})}function m(u,v){return r.post(i,{"function":"updatePost",post:JSON.stringify(u)}).success(function(w){h.clearCache=true;v(w)}).error(function(w){v(w)})}function g(u){if(isNaN(u)||u<1){h.pagina=1;return h}if(u>h.paginas){h.pagina=h.paginas;return h}h.pagina=u-1;h.start=h.pagina*h.paginacion;return h}function o(){if(h.pagina+1>h.paginas){return h}h.start=(h.pagina*h.paginacion);h.pagina=h.pagina+1;return h}function k(){if(h.pagina-2<0){return h}h.start=(h.pagina-2)*h.paginacion;h.pagina=h.pagina-1;return h}}c.$inject=[];function c(){this.paginas=1;this.pagina=1;this.paginacion=10;this.start=0;this.activos=false;this.clearCache=true}d.$inject=["$http","CommentVars","$cacheFactory","AcUtils"];function d(s,g,u,l){var q={};var i=e.replace("ac-posts.js","/includes/ac-posts.php");q.get=j;q.getByParams=v;q.create=p;q.update=m;q.remove=n;q.upvote=r;q.downvote=t;q.goToPagina=h;q.next=o;q.prev=k;return q;function j(x,A){var w=i+"?function=getComentarios&post_id="+x;var z=u.get("$http");var y=[];if(z.get(w)!=undefined){if(g.clearCache){z.remove(w)}else{y=z.get(w);A(y);return}}return s.get(w,{cache:true}).success(function(B){z.put(w,B);g.clearCache=false;g.paginas=(B.length%g.paginacion==0)?parseInt(B.length/g.paginacion):parseInt(B.length/g.paginacion)+1;A(B)}).error(function(B){A(B);g.clearCache=false})}function v(z,w,y,x,A){j(x,function(B){l.getByParams(z,w,y,B,A)})}function n(w,x){return s.post(i,{"function":"removeCarrito",comentario_id:w}).success(function(y){if(y!=="false"){g.clearCache=true;x(y)}}).error(function(y){x(y)})}function p(w,x){return s.post(i,{"function":"createComentario",comentario:JSON.stringify(w)}).success(function(y){g.clearCache=true;x(y)}).error(function(y){g.clearCache=true;x(y)})}function m(w,x){return s.post(i,{"function":"updateCarrito",carrito:JSON.stringify(w)}).success(function(y){g.clearCache=true;x(y)}).error(function(y){x(y)})}function r(){}function t(){}function h(w){if(isNaN(w)||w<1){g.pagina=1;return g}if(w>g.paginas){g.pagina=g.paginas;return g}g.pagina=w-1;g.start=g.pagina*g.paginacion;return g}function o(){if(g.pagina+1>g.paginas){return g}g.start=(g.pagina*g.paginacion);g.pagina=g.pagina+1;return g}function k(){if(g.pagina-2<0){return g}g.start=(g.pagina-2)*g.paginacion;g.pagina=g.pagina-1;return g}}f.$inject=["$rootScope"];function f(g){this.paginas=1;this.pagina=1;this.paginacion=10;this.start=0;this.comentarios=[];this.comentario={};this.clearCache=true;this.broadcast=function(){g.$broadcast("CommentVars")};this.listen=function(h){g.$on("CommentVars",h)}}})();